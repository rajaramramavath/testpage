<!DOCTYPE html>
<html>
<head>
  <title>Admin Timetable</title>
</head>
<body>
  <h1>Admin Panel</h1>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button id="login">Login</button>
  <hr>
  <input id="sectionName" placeholder="New Section">
  <button id="createSection">Create Section</button>
  <hr>
  <input id="sec" placeholder="Section">
  <input id="day" placeholder="Day">
  <input id="subject" placeholder="Subject">
  <input id="time" placeholder="Time">
  <button id="addEntry">Add Entry</button>
  <hr>
  <input id="delSec" placeholder="Section">
  <input id="delDay" placeholder="Day">
  <button id="deleteDay">Delete Day</button>

  <script type="module">
    import { db, auth, ref, set, push, remove, signInWithEmailAndPassword } from './firebase.js';

    let loggedIn = false;

    document.getElementById('login').addEventListener('click', async () => {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        await signInWithEmailAndPassword(auth, email, password);
        alert('Logged in');
        loggedIn = true;
      } catch (err) {
        alert('Login failed: ' + err.message);
      }
    });

    document.getElementById('createSection').addEventListener('click', async () => {
      if (!loggedIn) return alert('Login first');
      const section = document.getElementById('sectionName').value;
      await set(ref(db, 'timetable/' + section), {});
      alert('Section created');
    });

    document.getElementById('addEntry').addEventListener('click', async () => {
      if (!loggedIn) return alert('Login first');
      const sec = document.getElementById('sec').value;
      const day = document.getElementById('day').value;
      const subject = document.getElementById('subject').value;
      const time = document.getElementById('time').value;
      await push(ref(db, `timetable/${sec}/${day}`), { subject, time });
      alert('Entry added');
    });

    document.getElementById('deleteDay').addEventListener('click', async () => {
      if (!loggedIn) return alert('Login first');
      const sec = document.getElementById('delSec').value;
      const day = document.getElementById('delDay').value;
      await remove(ref(db, `timetable/${sec}/${day}`));
      alert('Day deleted');
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Firebase Admin Panel Demo</title>
</head>
<body>
  <h1>Firebase Admin Panel Demo</h1>

  <!-- Admin Login Form -->
  <div id="login-section">
    <h2>Login</h2>
    <input type="email" id="email" placeholder="Email"><br>
    <input type="password" id="password" placeholder="Password"><br>
    <button id="loginBtn">Login</button>
    <p id="login-status"></p>
  </div>

  <!-- Admin Panel (only visible after login) -->
  <div id="admin-panel" style="display:none;">
    <h2>Admin Panel</h2>
    <input type="text" id="dbKey" placeholder="Database Key"><br>
    <input type="text" id="dbValue" placeholder="Database Value"><br>
    <button id="saveBtn">Save to Database</button>
    <button id="readBtn">Read from Database</button>
    <p id="db-status"></p>
    <button id="logoutBtn">Logout</button>
  </div>

  <script type="module">
    // Import Firebase SDKs via CDN
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-analytics.js";
    import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
    import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js";

    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBEfI4QzJU2kc2PEp02x36BftvO6P5qJps",
      authDomain: "admindemon-b3823.firebaseapp.com",
      projectId: "admindemon-b3823",
      storageBucket: "admindemon-b3823.appspot.com",
      messagingSenderId: "33424574422",
      appId: "1:33424574422:web:96db3c6388d89d162c4677",
      measurementId: "G-188H3B2LSZ",
      databaseURL: "https://admindemon-b3823-default-rtdb.firebaseio.com"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);
    const db = getDatabase(app);

    // DOM elements
    const loginSection = document.getElementById('login-section');
    const adminPanel = document.getElementById('admin-panel');
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const loginStatus = document.getElementById('login-status');
    const saveBtn = document.getElementById('saveBtn');
    const readBtn = document.getElementById('readBtn');
    const dbStatus = document.getElementById('db-status');

    // Handle auth state change
    onAuthStateChanged(auth, (user) => {
      if (user) {
        loginSection.style.display = 'none';
        adminPanel.style.display = 'block';
      } else {
        loginSection.style.display = 'block';
        adminPanel.style.display = 'none';
      }
    });

    // Login
    loginBtn.addEventListener('click', () => {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
          loginStatus.textContent = 'Login successful ✅';
        })
        .catch((error) => {
          loginStatus.textContent = 'Error: ' + error.message;
        });
    });

    // Logout
    logoutBtn.addEventListener('click', () => {
      signOut(auth).then(() => {
        loginStatus.textContent = 'Logged out';
      });
    });

    // Save to database
    saveBtn.addEventListener('click', () => {
      const key = document.getElementById('dbKey').value;
      const value = document.getElementById('dbValue').value;

      set(ref(db, key), { value })
        .then(() => {
          dbStatus.textContent = `Saved "${value}" to "${key}" ✅`;
        })
        .catch((error) => {
          dbStatus.textContent = 'Error: ' + error.message;
        });
    });

    // Read from database
    readBtn.addEventListener('click', () => {
      const key = document.getElementById('dbKey').value;

      get(child(ref(db), key)).then((snapshot) => {
        if (snapshot.exists()) {
          dbStatus.textContent = `Value: ${JSON.stringify(snapshot.val())}`;
        } else {
          dbStatus.textContent = 'No data available';
        }
      }).catch((error) => {
        dbStatus.textContent = 'Error: ' + error.message;
      });
    });
  </script>
</body>
</html>
